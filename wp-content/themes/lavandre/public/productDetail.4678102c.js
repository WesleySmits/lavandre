(window.webpackJsonp=window.webpackJsonp||[]).push([["productDetail"],{"59Rd":function(t,e,a){"use strict";a.r(e),a.d(e,"default",(function(){return productDetail_ProductDetail}));var i=a("Gi9F"),r=a("RfZo"),n=a("T8im"),o=a("tBEf"),l=a("k92o");class AjaxAddToCart_AjaxAddToCart extends i.a{constructor(t){super(),this.variationData=[],this.ajaxEndpoint=window.location.origin+"/wp-admin/admin-ajax.php",this.form=t,this.button=this.form.querySelector('button[name="add-to-cart"]'),this.variationFields=Array.from(this.form.querySelectorAll(".product-detail__variations input")),this.handleChangeVariationAttribute();const e=this.form.attribute_pa_size.value;this.handleChangeVariationAttribute("attribute_pa_size",e)}initialize(){this.variationFields.forEach(t=>{t.addEventListener("change",()=>{this.handleChangeVariationAttribute(t.name,t.value)})}),this.button.addEventListener("click",this.handleAddToCartClick.bind(this))}handleChangeVariationAttribute(t="",e=""){const a={};for(let t=0;t<this.variationFields.length;t++){const e=this.variationFields[t].name;if(!this.form[e].value)return;a[e]=this.form[e].value}const i=this.findMatchingVariant(a);this.disableNonExistingVariants(t,e),i?this.form.variation_id.value=i:this.setFormInvalid()}setFormInvalid(){this.form.product_id.value="",this.form.variation_id.value=""}disableNonExistingVariants(t="",e=""){"attribute_pa_amount"!==t&&(t&&e&&this.variationFields.forEach(e=>{e.name!==t&&(e.disabled=!0)}),this.variationData.forEach(a=>{const i=a.attributes;if(!i)throw new Error("no attributes");i[t]===e&&this.variationFields.forEach(t=>{i[t.name]===t.value&&(t.disabled=!1)})}))}findMatchingVariant(t){let e=null;if(!this.variationData.length){const t=this.form.dataset.product_variations;if(!t)return null;if(this.variationData=JSON.parse(t),!this.variationData)return null}return this.variationData.forEach(a=>{const i=a.attributes;if(!i)throw new Error("no attributes");for(const[e,a]of Object.entries(i))if(t[e]!==a)return;e=a.variation_id}),e}handleAddToCartClick(t){var e;t.preventDefault();let a=0;this.form.querySelector('[name="variation_id"]');const i=this.form.querySelector('[name="variation_id"]');i&&(a=Number(i.value));let r=!0;if(Array.from(this.form.querySelectorAll("input")).forEach(t=>{t.dispatchEvent(new Event("validate")),t.validity.valid||(r=!1)}),!r)throw new Error("Product add form is not valid");const n=Number(null===(e=this.form.querySelector('input[name="quantity"]'))||void 0===e?void 0:e.value)||1,l={action:"ajaxaddtocart",product_id:this.button.value,quantity:n.toString(),variation_id:a.toString()};return Object(o.a)(l,this.ajaxEndpoint,null,this.onSuccess.bind(this),this.onFailure.bind(this),void 0,this.button),!1}onSuccess(t){if(!1===t.success)throw new Error("something is wrong");r.a.openSidePanel("cart-panel"),l.default.updateCart(),t.data.cartAmount&&Object(n.a)(t.data.cartAmount)}onFailure(){const t=this.button.closest("form");null!==t&&t.submit()}static onInit(t=document){const e=t.querySelector("form.cart");if(null===e)return;new AjaxAddToCart_AjaxAddToCart(e).initialize()}}var s=a("kR8q"),c=a("MT45");class ChangeVariantColor_ChangeVariantColor extends i.a{constructor(t){super(),this.elements=t}initialize(){const t=document.querySelector(".product-detail__variation__label--color");if(!this.elements.length||!t)return;const e=t.textContent;this.elements.forEach(a=>{a.addEventListener("change",()=>{const i=Object(c.b)(a.value);i&&(t.innerText=`${e}: ${i}`)}),a.checked&&a.dispatchEvent(new Event("change"))})}static onInit(t=document){const e=Array.from(t.querySelectorAll('[name="attribute_pa_color"]'));if(!e.length)return;new ChangeVariantColor_ChangeVariantColor(e).initialize()}}class ChangeVariantPrice_ChangeVariantPrice extends i.a{constructor(t){super(),this.ajaxEndpoint=window.location.origin+"/wp-admin/admin-ajax.php",this.regularPriceElement=null,this.salePriceElement=null,this.elements=t}initialize(){if(this.regularPriceElement=document.querySelector(".product-detail__price ins [data-product-price]")||document.querySelector(".product-detail__price [data-product-price]"),this.salePriceElement=document.querySelector(".product-detail__price del [data-product-price]"),!this.salePriceElement&&!this.regularPriceElement)return;const t=this.elements[0].closest("form");if(!t)return;const e=t.dataset.product_id;e&&this.elements.forEach(a=>{a.addEventListener("change",()=>{const a=t.querySelector('[name="variation_id"]'),i=null==a?void 0:a.value;if(!i||!e)return;const r={action:"ajaxgetvariantprice",product_id:e,variation_id:i};Object(o.a)(r,this.ajaxEndpoint,null,this.onSuccess.bind(this))})})}onSuccess(t){if(!t.data||!t.data.salePrice&&!t.data.regularPrice)throw new Error("No data");const e=Number(t.data.regularPrice).toFixed(2),a=Number(t.data.salePrice).toFixed(2);this.regularPriceElement&&e&&(this.regularPriceElement.innerText=e),this.salePriceElement&&a&&(this.salePriceElement.innerText=a)}static onInit(t=document){const e=Array.from(t.querySelectorAll('.product-detail__variations input[type="radio'));if(!e.length)return;new ChangeVariantPrice_ChangeVariantPrice(e).initialize()}}class ImageGallery_ImageGallery extends i.a{constructor(t){super(),this.element=t}initialize(){Array.from(this.element.querySelectorAll(".product-detail__gallery__thumbnails a")).forEach(t=>{t.addEventListener("click",e=>{e.preventDefault();const a=t.dataset.thumbnailId,i=this.element.querySelector(`[data-image-id="${a}"]`);if(null===i)return;const r=i.parentElement;Array.from(r.querySelectorAll("li.active")).forEach(t=>{t.classList.remove("active")}),i.classList.add("active")})})}static onInit(t=document){const e=t.querySelector(".product-detail__gallery");if(null===e)return;new ImageGallery_ImageGallery(e).initialize()}}var d=a("Q0Az");class productDetail_ProductDetail extends d.a{constructor(){super(...arguments),this.components=[AjaxAddToCart_AjaxAddToCart,s.a,ImageGallery_ImageGallery,ChangeVariantPrice_ChangeVariantPrice,ChangeVariantColor_ChangeVariantColor]}}!function productDetailInit(){(new productDetail_ProductDetail).initialize()}()}},[["59Rd","runtime",0]]]);